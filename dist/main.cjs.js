var E=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var F=Object.getOwnPropertyNames;var w=Object.prototype.hasOwnProperty;var L=(a,n)=>{for(var s in n)E(a,s,{get:n[s],enumerable:!0})},M=(a,n,s,u)=>{if(n&&typeof n=="object"||typeof n=="function")for(let l of F(n))!w.call(a,l)&&l!==s&&E(a,l,{get:()=>n[l],enumerable:!(u=D(n,l))||u.enumerable});return a};var j=a=>M(E({},"__esModule",{value:!0}),a);var O={};L(O,{FormManager:()=>d});module.exports=j(O);var g=require("check-rule-mate");function A(a,n,s,u,l){let m={onceError:!1};async function q(e){var t;if(!m.onceError||!n[e.target.name])return;let o=h(a),r=x(o),c=await(0,g.dataValidate)({...o,[e.target.name]:e.target.value},{validationHelpers:u,rules:s,dataRule:{...r,[e.target.name]:n[e.target.name]},dataErrorMessages:l});b(e.target,(t=c==null?void 0:c.dataErrors)==null?void 0:t[e.target.name])}async function S(e,{onSuccess:o,onError:r}={onSuccess:null,onError:null}){e.preventDefault();let c=h(a),t=await(0,g.dataValidate)(c,{validationHelpers:u,rules:s,dataRule:n,dataErrorMessages:l});t.error?(m.onceError=!0,a.querySelectorAll("input").forEach(i=>{var f;b(i,(f=t==null?void 0:t.dataErrors)==null?void 0:f[i.name])}),r&&typeof r=="function"&&r(t)):t.ok&&o&&typeof o=="function"&&o({...t,formData:c})}function v(){a.querySelectorAll("input").forEach(e=>{let o=e.parentElement,r=o.querySelector(".check-rule-mate-error");e.value="",o.classList.remove("field-error"),r&&o.removeChild(r)}),m.onceError=!1}function h(e){let o=e.querySelectorAll("input, textarea, select"),r={};return o.forEach(c=>{let{name:t,type:i,value:f,checked:p}=c;t&&(i==="checkbox"||i==="radio"?p&&(r[t]=f):r[t]=f)}),r}function x(e){let o={};return Object.keys(e).forEach(r=>{o[r]={rule:"hasText",required:!1}}),o}function C(){Object.keys(n).forEach(e=>{var o,r;(o=s[n[e].rule])!=null&&o.attributes&&Object.keys((r=s[n[e].rule])==null?void 0:r.attributes).forEach(c=>{var t,i,f;if((i=(t=s[n[e].rule])==null?void 0:t.attributes)!=null&&i[c]){let p=a.querySelector(`input[name=${e}]`);p[c]=(f=s[n[e].rule])==null?void 0:f.attributes[c]}}),n[e].attributes&&Object.keys(n[e].attributes).forEach(c=>{if(c==="label"){let t=a.querySelector(`label[for=${e}]`);t.textContent=n[e].attributes[c]}else{let t=a.querySelector(`input[name=${e}]`);t[c]=n[e].attributes[c]}})})}function b(e,o){let r=e.parentElement,c=r.querySelector(".check-rule-mate-error");if(r.classList.add("field-error"),o)if(c)c.textContent=o.errorMessage;else{let t=window.document.createElement("span");t.classList.add("check-rule-mate-error"),t.innerHTML=o.errorMessage,r.appendChild(t)}else r.classList.remove("field-error"),c&&r.removeChild(c)}return{handleFormSubmit:S,handleFormReset:v,handleInputChange:q,addAttributes:C,getFormData:h}}var d=A;0&&(module.exports={FormManager});
