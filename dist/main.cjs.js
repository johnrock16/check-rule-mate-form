var E=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var L=Object.prototype.hasOwnProperty;var M=(l,r)=>{for(var s in r)E(l,s,{get:r[s],enumerable:!0})},A=(l,r,s,f)=>{if(r&&typeof r=="object"||typeof r=="function")for(let u of C(r))!L.call(l,u)&&u!==s&&E(l,u,{get:()=>r[u],enumerable:!(f=w(r,u))||f.enumerable});return l};var j=l=>A(E({},"__esModule",{value:!0}),l);var O={};M(O,{FormManager:()=>h});module.exports=j(O);var v=require("check-rule-mate");function h(l,{schema:r,rules:s,validationHelpers:f,errorMessages:u,options:S}){let d=(0,v.createValidator)(m(l),{validationHelpers:f,rules:s,schema:r,errorMessages:u,options:S}),p={onceError:!1};async function q(e){if(!p.onceError||!r[e.target.name])return;let a=m(l);d.setData({...a,[e.target.name]:e.target.value});let o=await d.validateField(e.target.name);b(e.target,o==null?void 0:o.errors)}async function x(e){return e.preventDefault(),new Promise(async(a,o)=>{let n=m(l);d.setData(n);let t=await d.validate();t.error?(p.onceError=!0,l.querySelectorAll("input, select, textarea").forEach(c=>{var i;b(c,(i=t==null?void 0:t.errors)==null?void 0:i[c.name])}),a({...t,formData:n})):t.ok&&a({...t,formData:n}),o({error:!0})})}function D(){l.querySelectorAll("input, select, textarea").forEach(e=>{let a=e.parentElement,o=a.querySelector(".check-rule-mate-error");e.value="",a.classList.remove("field-error"),o&&a.removeChild(o)}),p.onceError=!1}function m(e){let a=e.querySelectorAll("input, textarea, select"),o={};return a.forEach(n=>{let{name:t,type:c,value:i,checked:g}=n;t&&(c==="checkbox"||c==="radio"?g&&(o[t]=i):o[t]=i)}),o}function F(){Object.keys(r).forEach(e=>{var a,o;(a=s[r[e].rule])!=null&&a.attributes&&Object.keys((o=s[r[e].rule])==null?void 0:o.attributes).forEach(n=>{var t,c,i;if((c=(t=s[r[e].rule])==null?void 0:t.attributes)!=null&&c[n]){let g=l.querySelector(`input[name=${e}]`);g[n]=(i=s[r[e].rule])==null?void 0:i.attributes[n]}}),r[e].attributes&&Object.keys(r[e].attributes).forEach(n=>{if(n==="label"){let t=l.querySelector(`label[for=${e}]`);t.textContent=r[e].attributes[n]}else{let t=l.querySelector(`input[name=${e}]`);t[n]=r[e].attributes[n]}})})}function b(e,a){let o=e.parentElement,n=o.querySelector(".check-rule-mate-error");if(o.classList.add("field-error"),a)if(n)n.textContent=a.message;else{let t=window.document.createElement("span");t.classList.add("check-rule-mate-error"),t.innerHTML=a.message,o.appendChild(t)}else o.classList.remove("field-error"),n&&o.removeChild(n)}return{handleFormSubmit:x,handleFormReset:D,handleInputChange:q,addAttributes:F,getFormData:m}}0&&(module.exports={FormManager});
